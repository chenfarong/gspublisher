{"version":3,"sources":["main.js"],"names":["cc","Class","extends","Component","properties","netEvListener","netMsgListener","Version","EditBox","WsHost","Label","TxLog","NetReady","Boolean","CmdWait","netEvent","event","msg","string","text","console","log","JSON","stringify","netSocketEvent","target","cmd","XNetEvent","CONNECTED","XNet","ws_host","node","color","opacity","Send","CONNECT_TIMEOUT","CONNECT_ERROR","CONNECT","director","getScheduler","schedule","ConnectCheck","netMsgProc","onLoad","callback","EarAdd","ListenerAdd","start","ClickBuild","ver","app","Close","Host","Open","ClickTestUpgrade","ClickAuditInstall","ClickGameSwitchPort","ClickAuditPass"],"mappings":"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","file":"main.js","sourceRoot":"../../../../assets/Script","sourcesContent":["import { XNet, XNetEvent } from \"./Network\";\n\n//import { TipsManager } from \"./TipsManager\";\n//const TipsManager = require(\"./TipsManager\");\n\n// Learn cc.Class:\n//  - [Chinese] http://docs.cocos.com/creator/manual/zh/scripting/class.html\n//  - [English] http://www.cocos2d-x.org/docs/creator/en/scripting/class.html\n// Learn Attribute:\n//  - [Chinese] http://docs.cocos.com/creator/manual/zh/scripting/reference/attributes.html\n//  - [English] http://www.cocos2d-x.org/docs/creator/en/scripting/reference/attributes.html\n// Learn life-cycle callbacks:\n//  - [Chinese] http://docs.cocos.com/creator/manual/zh/scripting/life-cycle-callbacks.html\n//  - [English] http://www.cocos2d-x.org/docs/creator/en/scripting/life-cycle-callbacks.html\n\ncc.Class({\n  extends: cc.Component,\n\n  properties: {\n    netEvListener: null,\n    netMsgListener: null,\n    Version: cc.EditBox,\n    WsHost: cc.Label,\n    TxLog: cc.Label,\n    NetReady: Boolean,\n    CmdWait: null\n  },\n\n  // LIFE-CYCLE CALLBACKS:\n\n  netEvent: function(event, msg) {\n    //这里处理游戏来的所有事件\n    /*\n    if (event == XOpcodes.XC_NET_CONNECTED) {\n      this.auth();\n      return;\n    }*/\n\n    if (event == \"GX_APP_BUILD_MSG\") {\n      this.TxLog.string = msg.text;\n    }\n    console.log(\"netEvent:\" + JSON.stringify(msg));\n  },\n\n  netSocketEvent: function(msg, target) {\n    if (msg.cmd == XNetEvent.CONNECTED) {\n      target.WsHost.string = XNet.ws_host;\n      target.WsHost.node.color = cc.color(0, 255, 0, 100);\n      target.WsHost.node.opacity = 255;\n      target.NetReady = true;\n\n      if (target.CmdWait) {\n        XNet.Send(JSON.stringify(target.CmdWait));\n      }\n    }\n\n    if (\n      msg.cmd == XNetEvent.CONNECT_TIMEOUT ||\n      msg.cmd == XNetEvent.CONNECT_ERROR\n    ) {\n      target.TxLog.string = \"网络连接错误\";\n    }\n\n    if (msg.cmd == XNetEvent.CONNECT) {\n      target.TxLog.string = \"连接->\" + XNet.ws_host;\n      cc.director\n        .getScheduler()\n        .schedule(target.ConnectCheck, target, 6, 1, 6, false);\n    }\n  },\n\n  ConnectCheck: function() {\n    XNet.ConnectCheck(false);\n  },\n\n  netMsgProc: function(msg, target) {},\n\n  onLoad() {\n    this.netEvListener = { callback: this.netSocketEvent, target: this };\n    this.netMsgListener = { callback: this.netMsgProc, target: this };\n\n    XNet.EarAdd(this);\n    XNet.ListenerAdd(XNetEvent.CONNECTED, this.netEvListener);\n    XNet.ListenerAdd(XNetEvent.CONNECT, this.netEvListener);\n    XNet.ListenerAdd(XNetEvent.CONNECT_ERROR, this.netEvListener);\n    XNet.ListenerAdd(XNetEvent.CONNECT_TIMEOUT, this.netEvListener);\n\n    //XNet.Host(\"ws://192.168.1.99:3737/appPub\");\n    //XNet.Open();\n  },\n\n  start() {},\n\n  ClickBuild() {\n    this.CmdWait = {\n      cmd: \"GX_APP_BUILD\",\n      ver: this.Version.string,\n      app: \"XX\"\n    };\n\n    XNet.Close();\n    XNet.Host(\"ws://192.168.1.99:3737/appPub\");\n    XNet.Open();\n\n    //let ver = this.Version.string;\n    //console.log(\"build...\" + JSON.stringify(scmd));\n    //XNet.Send(JSON.stringify(scmd));\n  },\n\n  ClickTestUpgrade() {\n    XNet.Close();\n    XNet.Host(\"ws://test.9966886699.com:3737/appPub\");\n    XNet.Open();\n    this.CmdWait = {\n      cmd: \"GX_APP_UPGRADE\",\n      ver: this.Version.string,\n      app: \"XX\"\n    };\n  },\n\n  ClickAuditInstall() {\n    XNet.Close();\n    XNet.Host(\"ws://app.9966886699.com:3737/appPub\");\n    XNet.Open();\n    this.CmdWait = {\n      cmd: \"GX_APP_UPGRADE\",\n      ver: this.Version.string,\n      app: \"XX\"\n    };\n  },\n\n  ClickGameSwitchPort() {\n    //console.log(\"ClickGameSwitchPort\");\n    //TipsManager.CreateTips(\"现不支持\");\n  },\n\n  ClickAuditPass() {}\n\n  // update (dt) {},\n});\n"]}