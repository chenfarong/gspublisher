{"version":3,"sources":["..\\..\\..\\..\\assets\\Script/assets\\Script\\main.js"],"names":["cc","Class","extends","Component","properties","netEvListener","netMsgListener","Version","EditBox","WsHost","Label","TxLog","NetReady","Boolean","CmdWait","netEvent","event","msg","string","text","console","log","JSON","stringify","netSocketEvent","target","cmd","XNetEvent","CONNECTED","XNet","ws_host","node","color","opacity","Send","CONNECT_TIMEOUT","CONNECT_ERROR","CONNECT","director","getScheduler","schedule","ConnectCheck","netMsgProc","onLoad","callback","EarAdd","ListenerAdd","start","ClickBuild","ver","app","Close","Host","Open","ClickTestUpgrade","ClickAuditInstall","ClickGameSwitchPort","ClickAuditPass"],"mappings":"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","file":"main.js","sourceRoot":"..\\..\\..\\..\\assets\\Script","sourcesContent":["import { XNet, XNetEvent } from \"./Network\";\r\n\r\n//import { TipsManager } from \"./TipsManager\";\r\n//const TipsManager = require(\"./TipsManager\");\r\n\r\n// Learn cc.Class:\r\n//  - [Chinese] http://docs.cocos.com/creator/manual/zh/scripting/class.html\r\n//  - [English] http://www.cocos2d-x.org/docs/creator/en/scripting/class.html\r\n// Learn Attribute:\r\n//  - [Chinese] http://docs.cocos.com/creator/manual/zh/scripting/reference/attributes.html\r\n//  - [English] http://www.cocos2d-x.org/docs/creator/en/scripting/reference/attributes.html\r\n// Learn life-cycle callbacks:\r\n//  - [Chinese] http://docs.cocos.com/creator/manual/zh/scripting/life-cycle-callbacks.html\r\n//  - [English] http://www.cocos2d-x.org/docs/creator/en/scripting/life-cycle-callbacks.html\r\n\r\ncc.Class({\r\n  extends: cc.Component,\r\n\r\n  properties: {\r\n    netEvListener: null,\r\n    netMsgListener: null,\r\n    Version: cc.EditBox,\r\n    WsHost: cc.Label,\r\n    TxLog: cc.Label,\r\n    NetReady: Boolean,\r\n    CmdWait: null\r\n  },\r\n\r\n  // LIFE-CYCLE CALLBACKS:\r\n\r\n  netEvent: function(event, msg) {\r\n    //这里处理游戏来的所有事件\r\n    /*\r\n    if (event == XOpcodes.XC_NET_CONNECTED) {\r\n      this.auth();\r\n      return;\r\n    }*/\r\n\r\n    if (event == \"GX_APP_BUILD_MSG\") {\r\n      this.TxLog.string = msg.text;\r\n    }\r\n    console.log(\"netEvent:\" + JSON.stringify(msg));\r\n  },\r\n\r\n  netSocketEvent: function(msg, target) {\r\n    if (msg.cmd == XNetEvent.CONNECTED) {\r\n      target.WsHost.string = XNet.ws_host;\r\n      target.WsHost.node.color = cc.color(0, 255, 0, 100);\r\n      target.WsHost.node.opacity = 255;\r\n      target.NetReady = true;\r\n\r\n      if (target.CmdWait) {\r\n        XNet.Send(JSON.stringify(target.CmdWait));\r\n      }\r\n    }\r\n\r\n    if (\r\n      msg.cmd == XNetEvent.CONNECT_TIMEOUT ||\r\n      msg.cmd == XNetEvent.CONNECT_ERROR\r\n    ) {\r\n      target.TxLog.string = \"网络连接错误\";\r\n    }\r\n\r\n    if (msg.cmd == XNetEvent.CONNECT) {\r\n      target.TxLog.string = \"连接->\" + XNet.ws_host;\r\n      cc.director\r\n        .getScheduler()\r\n        .schedule(target.ConnectCheck, target, 6, 1, 6, false);\r\n    }\r\n  },\r\n\r\n  ConnectCheck: function() {\r\n    XNet.ConnectCheck(false);\r\n  },\r\n\r\n  netMsgProc: function(msg, target) {},\r\n\r\n  onLoad() {\r\n    this.netEvListener = { callback: this.netSocketEvent, target: this };\r\n    this.netMsgListener = { callback: this.netMsgProc, target: this };\r\n\r\n    XNet.EarAdd(this);\r\n    XNet.ListenerAdd(XNetEvent.CONNECTED, this.netEvListener);\r\n    XNet.ListenerAdd(XNetEvent.CONNECT, this.netEvListener);\r\n    XNet.ListenerAdd(XNetEvent.CONNECT_ERROR, this.netEvListener);\r\n    XNet.ListenerAdd(XNetEvent.CONNECT_TIMEOUT, this.netEvListener);\r\n\r\n    //XNet.Host(\"ws://192.168.1.99:3737/appPub\");\r\n    //XNet.Open();\r\n  },\r\n\r\n  start() {},\r\n\r\n  ClickBuild() {\r\n    this.CmdWait = {\r\n      cmd: \"GX_APP_BUILD\",\r\n      ver: this.Version.string,\r\n      app: \"XX\"\r\n    };\r\n\r\n    XNet.Close();\r\n    XNet.Host(\"ws://192.168.1.99:3737/appPub\");\r\n    XNet.Open();\r\n\r\n    //let ver = this.Version.string;\r\n    //console.log(\"build...\" + JSON.stringify(scmd));\r\n    //XNet.Send(JSON.stringify(scmd));\r\n  },\r\n\r\n  ClickTestUpgrade() {\r\n    XNet.Close();\r\n    XNet.Host(\"ws://test.9966886699.com:3737/appPub\");\r\n    XNet.Open();\r\n    this.CmdWait = {\r\n      cmd: \"GX_APP_UPGRADE\",\r\n      ver: this.Version.string,\r\n      app: \"XX\"\r\n    };\r\n  },\r\n\r\n  ClickAuditInstall() {\r\n    XNet.Close();\r\n    XNet.Host(\"ws://app.9966886699.com:3737/appPub\");\r\n    XNet.Open();\r\n    this.CmdWait = {\r\n      cmd: \"GX_APP_UPGRADE\",\r\n      ver: this.Version.string,\r\n      app: \"XX\"\r\n    };\r\n  },\r\n\r\n  ClickGameSwitchPort() {\r\n    //console.log(\"ClickGameSwitchPort\");\r\n    //TipsManager.CreateTips(\"现不支持\");\r\n  },\r\n\r\n  ClickAuditPass() {}\r\n\r\n  // update (dt) {},\r\n});\r\n"]}