{"version":3,"sources":["..\\..\\..\\..\\assets\\Script/assets\\Script\\Game.js"],"names":["XGame","cc","Class","extends","Component","statics","clientVersion","resVersion","username","password","accid","aid","token","whereResult","sdtime","whereUrl","Where","callback","who","n","url","req","cmd","ver","realm","xhr","loader","getXMLHttpRequest","onreadystatechange","readyState","status","JSON","parse","responseText","open","timeout","ontimeout","console","error","send","stringify","Version","Update","dt"],"mappings":";;;;;;;;;AAAA;;AAEA,IAAIA,QAAQC,GAAGC,KAAH,CAAS;AACnBC,WAASF,GAAGG,SADO;AAEnBC,WAAS;AACPC,mBAAe,KADR,EACe;AACtBC,gBAAY,KAFL,EAEY;AACnBC,cAAU,EAHH;AAIPC,cAAU,EAJH;AAKPC,WAAO,EALA,EAKI;AACXC,SAAK,EANE,EAME;AACTC,WAAO,EAPA,EAOI;AACXC,iBAAa,EARN,EAQU;AACjBC,YAAQ,CATD,EASI;;AAEXC,cAAU,CACR,iCADQ,EAER,iCAFQ,EAGR,iCAHQ,CAXH;;AAiBP;AACAC,WAAO,eAASC,QAAT,EAAmBC,GAAnB,EAAwBC,CAAxB,EAA2B;AAChCA,UAAIA,IAAI,CAAR;AACA,UAAIC,MAAM,iCAAV;AACAA,YAAM,KAAKL,QAAL,CAAcI,CAAd,CAAN;;AAEA;AACA,UAAIE,MAAM,EAAV;AACAA,UAAIC,GAAJ,GAAU,UAAV;AACAD,UAAIE,GAAJ,GAAU,MAAV;AACAF,UAAIG,KAAJ,GAAY,SAAZ;AACA;AACA,UAAIC,MAAMxB,GAAGyB,MAAH,CAAUC,iBAAV,EAAV;AACAF,UAAIG,kBAAJ,GAAyB,YAAW;AAClC,YAAIH,IAAII,UAAJ,KAAmB,CAAvB,EAA0B;AACxB;AACA,cAAIJ,IAAIK,MAAJ,KAAe,GAAnB,EAAwB;AACtB;AACA,iBAAKjB,WAAL,GAAmBkB,KAAKC,KAAL,CAAWP,IAAIQ,YAAf,CAAnB;AACAhB,qBAASC,GAAT,EAAcO,IAAIQ,YAAlB;AACD,WAJD,MAIO;AACLhB,qBAASC,GAAT,EAAc,IAAd;AACD;AACF;AACF,OAXD;AAYAO,UAAIS,IAAJ,CAAS,MAAT,EAAiBd,GAAjB;AACAK,UAAIU,OAAJ,GAAc,IAAd,CAzBgC,CAyBZ;AACpBV,UAAIW,SAAJ,GAAgB,YAAM;AACpBC,gBAAQC,KAAR,CAAc,WAAd;AACArB,iBAASC,GAAT,EAAc,IAAd;AACD,OAHD;;AAKAO,UAAIc,IAAJ,CAASR,KAAKS,SAAL,CAAenB,GAAf,CAAT;AACD,KAlDM;;AAoDP;AACAoB,aAAS,iBAASxB,QAAT,EAAmBC,GAAnB,EAAwB,CAAE,CArD5B;;AAuDP;AACA;AACAwB,YAAQ,gBAASC,EAAT,EAAa,CAAE;AAzDhB;AAFU,CAAT,CAAZ;;QA+DS3C,QAAAA","file":"Game.js","sourceRoot":"..\\..\\..\\..\\assets\\Script","sourcesContent":["//import { XNet } from \"./Network\";\r\n\r\nvar XGame = cc.Class({\r\n  extends: cc.Component,\r\n  statics: {\r\n    clientVersion: 10000, //客户端程序版本号\r\n    resVersion: 10000, //资源版本号\r\n    username: \"\",\r\n    password: \"\",\r\n    accid: \"\", //账号\r\n    aid: \"\", //角色编号\r\n    token: \"\", //令牌\r\n    whereResult: {}, //游戏服务位置\r\n    sdtime: 0, //和服务器之间的时间差 毫秒\r\n\r\n    whereUrl: [\r\n      \"http://where.9966886699.com/xx/\",\r\n      \"http://where.9966886699.com/xx/\",\r\n      \"http://where.9966886699.com/xx/\"\r\n    ],\r\n\r\n    //向服务获取游戏服务器位置\r\n    Where: function(callback, who, n) {\r\n      n = n % 3;\r\n      let url = \"http://where.9966886699.com/xx/\";\r\n      url = this.whereUrl[n];\r\n\r\n      //从位置中心查询游戏服务器位置 http post 获得\r\n      let req = {};\r\n      req.cmd = \"GX_WHERE\";\r\n      req.ver = \"1000\";\r\n      req.realm = \"android\";\r\n      //XNet.HttpPost(\"http://where.9966886699.com/xx/\", req);\r\n      var xhr = cc.loader.getXMLHttpRequest();\r\n      xhr.onreadystatechange = function() {\r\n        if (xhr.readyState === 4) {\r\n          //console.log(\"recv:\" + xhr.responseText);\r\n          if (xhr.status === 200) {\r\n            //收到内容后处理\r\n            this.whereResult = JSON.parse(xhr.responseText);\r\n            callback(who, xhr.responseText);\r\n          } else {\r\n            callback(who, null);\r\n          }\r\n        }\r\n      };\r\n      xhr.open(\"POST\", url);\r\n      xhr.timeout = 5000; //5 seconds for timeout\r\n      xhr.ontimeout = () => {\r\n        console.error(\"Timeout!!\");\r\n        callback(who, null);\r\n      };\r\n\r\n      xhr.send(JSON.stringify(req));\r\n    },\r\n\r\n    //向游戏服务器查询版本号\r\n    Version: function(callback, who) {},\r\n\r\n    //这里实现逻辑帧\r\n    //dt 上一帧到本帧时间差\r\n    Update: function(dt) {}\r\n  }\r\n});\r\n\r\nexport { XGame };\r\n"]}